<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="csrf-token" content="{{ csrfToken }}" />
  <title>
    X
  </title>
  <script src="https://cdn.tailwindcss.com">

  </script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            "twitter-blue": "#1d9bf0",
            "dark-gray": "#16181c",
            "medium-gray": "#2f3336",
            "light-gray": "#71767b"
          }
        }
      }
    };
  </script>
  <script>
    // Gestion des thÃ¨mes
    const themes = {
      noir: {
        bg: "bg-black",
        text: "text-white",
        border: "border-gray-800",
        sidebar: "bg-black",
        hover: "hover:bg-gray-900"
      },
      blanc: {
        bg: "bg-white",
        text: "text-black",
        border: "border-gray-200",
        sidebar: "bg-white",
        hover: "hover:bg-gray-100"
      },
      vert: {
        bg: "bg-green-900",
        text: "text-green-50",
        border: "border-green-700",
        sidebar: "bg-green-900",
        hover: "hover:bg-green-800"
      },
      rouge: {
        bg: "bg-red-900",
        text: "text-red-50",
        border: "border-red-700",
        sidebar: "bg-red-900",
        hover: "hover:bg-red-800"
      },
      rose: {
        bg: "bg-pink-900",
        text: "text-pink-50",
        border: "border-pink-700",
        sidebar: "bg-pink-900",
        hover: "hover:bg-pink-800"
      },
      bleu: {
        bg: "bg-blue-900",
        text: "text-blue-50",
        border: "border-blue-700",
        sidebar: "bg-blue-900",
        hover: "hover:bg-blue-800"
      }
    };

    function changeTheme(themeName) {
      const theme = themes[themeName];
      const body = document.body;
      const sidebar = document.querySelector(".sidebar");
      const elements = document.querySelectorAll("[data-theme]");
      // Supprimer toutes les classes de thÃ¨me existantes
      Object.values(themes).forEach(t => {
        body.classList.remove(t.bg, t.text);
        if (sidebar) {
          sidebar.classList.remove(t.sidebar, t.border);
        }
      });
      // Appliquer le nouveau thÃ¨me
      body.classList.add(theme.bg, theme.text);
      if (sidebar) {
        sidebar.classList.add(theme.sidebar, theme.border);
      }
      // Sauvegarder le thÃ¨me
      localStorage.setItem("selectedTheme", themeName);
    }
    // Charger le thÃ¨me sauvegardÃ©

    document.addEventListener("DOMContentLoaded", function () {
      const savedTheme = localStorage.getItem("selectedTheme") || "noir";
      changeTheme(savedTheme);

      // Gestion du message de bienvenue
      const welcomeMessage = document.getElementById("welcomeMessage");
      if (welcomeMessage) {
        // VÃ©rifier si c'est une nouvelle connexion
        const isNewLogin = sessionStorage.getItem("showWelcome");
        if (isNewLogin === "true") {
          // Afficher le message avec animation
          setTimeout(() => {
            welcomeMessage.classList.remove("opacity-0");
            welcomeMessage.classList.add("opacity-100");
          }, 300);

          // Faire disparaÃ®tre le message aprÃ¨s 4 secondes
          setTimeout(() => {
            welcomeMessage.classList.remove("opacity-100");
            welcomeMessage.classList.add("opacity-0");
          }, 4000);

          // Supprimer l'indicateur de nouvelle connexion
          sessionStorage.removeItem("showWelcome");
        }
      }
    });
  </script>
</head>

<body class="bg-black text-white font-sans">
  <div class="flex min-h-screen">
    <!-- Sidebar gauche -->
    <div class="w-64 flex flex-col bg-black border-r border-gray-800 fixed h-full z-30 sidebar">
      <div class="flex-1 flex flex-col min-h-0">
        <!-- Logo X -->
        <div class="mb-2 p-3">
          <svg class="w-6 h-6 fill-white" viewBox="0 0 24 24">
            <path
              d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
          </svg>
        </div>

        <!-- Message de bienvenue -->
        @if(auth && auth.user)
        <div id="welcomeMessage" class="px-3 mb-2 transition-opacity duration-1000 opacity-0">
          <p class="text-white text-lg font-semibold">Bonjour, {{ auth.user.username }} !</p>
        </div>
        @endif

        <!-- Navigation -->
        <nav class="flex-1 px-3 overflow-hidden">
          <div class="space-y-0.5">
            <!-- Maison -->
            <a href="/dashboard"
              class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M12 9c-2.209 0-4 1.791-4 4s1.791 4 4 4 4-1.791 4-4-1.791-4-4-4zm9.707-5.293l-9-9a.999.999 0 00-1.414 0l-9 9A.999.999 0 003 5.414V19a3 3 0 003 3h4a1 1 0 001-1v-3a1 1 0 011-1h2a1 1 0 011 1v3a1 1 0 001 1h4a3 3 0 003-3V5.414a.999.999 0 00-.293-.707z" />
              </svg>
              <span class="text-lg">Maison</span>
            </a>

            <!-- Explorer / Recherche -->
            <a href="/search"
              class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              <span class="text-lg">Recherche</span>
            </a>

            <!-- Notifications -->
            <button id="notificationsBtn"
              class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200 w-full text-left">
              <div class="relative">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 17h5l-5 5v-5z M4 19h16a2 2 0 002-2V7a2 2 0 00-2-2H4a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                <span id="notificationBadge"
                  class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full text-xs px-1 hidden">0</span>
              </div>
              <span class="text-lg">Notifications</span>
            </button>

            <!-- Messages -->
            <a href="#"
              class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
              <span class="text-lg">Messages</span>
            </a>

            <!-- Grok -->
            <button type="button" onclick="openGrokModal()"
              class="w-full flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
              </svg>
              <span class="text-lg">Grok</span>
            </button>

            <!-- Signets -->
            <a href="#"
              class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
              </svg>
              <span class="text-lg">Signets</span>
            </a>

            <!-- Prime -->
            <a href="#"
              class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200">
              <svg class="w-5 h-5 fill-white" viewBox="0 0 24 24">
                <path
                  d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
              </svg>
              <span class="text-lg">Prime</span>
            </a>

            <!-- Profil -->
            <a href="/profile"
              class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
              </svg>
              <span class="text-lg">Profil</span>
            </a>

            <!-- Plus d'options -->
            <div class="relative">
              <button onclick="toggleMoreMenu()"
                class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200 w-full">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                </svg>
                <span class="text-lg">Plus</span>
              </button>

              <!-- Menu dÃ©roulant -->
              <div id="moreMenu"
                class="hidden absolute left-0 bottom-full mb-2 bg-black border border-gray-700 rounded-2xl p-2 shadow-lg z-50 min-w-max">
                <a href="/privacy-settings"
                  class="flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-900 transition-all duration-200">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                  </svg>
                  <span class="text-sm">ConfidentialitÃ©</span>
                </a>
                <a href="/blocked-users"
                  class="flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-900 transition-all duration-200">
                  <i class="fas fa-ban text-red-400"></i>
                  <span class="text-sm">Utilisateurs bloquÃ©s</span>
                </a>
                <div class="border-t border-gray-700 my-1">
                </div>
                <a href="#"
                  class="flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-900 transition-all duration-200">
                  <i class="fas fa-cog"></i>
                  <span class="text-sm">ParamÃ¨tres</span>
                </a>
                <a href="#"
                  class="flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-900 transition-all duration-200">
                  <i class="fas fa-question-circle"></i>
                  <span class="text-sm">Aide</span>
                </a>
              </div>
            </div>

            <!-- Changement de thÃ¨me -->
            <div class="relative">
              <button onclick="toggleThemeSelector()"
                class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 transition-all duration-200 w-full">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z" />
                </svg>
                <span class="text-lg">ThÃ¨me</span>
              </button>

              <!-- SÃ©lecteur de thÃ¨me -->
              <div id="themeSelector"
                class="hidden absolute left-0 bottom-full mb-2 bg-gray-800 rounded-2xl p-4 shadow-lg z-50 min-w-max">
                <h3 class="text-white font-bold mb-3 text-sm">
                  Choisir un thÃ¨me
                </h3>
                <div class="grid grid-cols-3 gap-2">
                  <button onclick="changeTheme('noir')"
                    class="theme-btn flex flex-col items-center p-2 rounded-lg hover:bg-gray-700 transition-all">
                    <div class="w-6 h-6 bg-black border border-gray-600 rounded-full mb-1">
                    </div>
                    <span class="text-xs text-white">Noir</span>
                  </button>
                  <button onclick="changeTheme('blanc')"
                    class="theme-btn flex flex-col items-center p-2 rounded-lg hover:bg-gray-700 transition-all">
                    <div class="w-6 h-6 bg-white border border-gray-600 rounded-full mb-1">
                    </div>
                    <span class="text-xs text-white">Blanc</span>
                  </button>
                  <button onclick="changeTheme('vert')"
                    class="theme-btn flex flex-col items-center p-2 rounded-lg hover:bg-gray-700 transition-all">
                    <div class="w-6 h-6 bg-green-600 rounded-full mb-1">
                    </div>
                    <span class="text-xs text-white">Vert</span>
                  </button>
                  <button onclick="changeTheme('rouge')"
                    class="theme-btn flex flex-col items-center p-2 rounded-lg hover:bg-gray-700 transition-all">
                    <div class="w-6 h-6 bg-red-600 rounded-full mb-1">
                    </div>
                    <span class="text-xs text-white">Rouge</span>
                  </button>
                  <button onclick="changeTheme('rose')"
                    class="theme-btn flex flex-col items-center p-2 rounded-lg hover:bg-gray-700 transition-all">
                    <div class="w-6 h-6 bg-pink-600 rounded-full mb-1">
                    </div>
                    <span class="text-xs text-white">Rose</span>
                  </button>
                  <button onclick="changeTheme('bleu')"
                    class="theme-btn flex flex-col items-center p-2 rounded-lg hover:bg-gray-700 transition-all">
                    <div class="w-6 h-6 bg-blue-600 rounded-full mb-1">
                    </div>
                    <span class="text-xs text-white">Bleu</span>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Bouton Poster -->
          <button onclick="focusTweetComposer()"
            class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 rounded-full mt-4 transition-all duration-200 text-sm">
            Poster
          </button>
        </nav>

        <!-- Profil utilisateur -->
        <div class="flex-shrink-0 px-4 pb-2 pt-2">
          <div
            class="flex items-center space-x-3 p-2 rounded-full hover:bg-gray-900 cursor-pointer transition-all duration-200 mb-2">
            <div
              class="w-8 h-8 {{ user.avatar ? '' : 'bg-gradient-to-r from-pink-500 to-purple-600' }} rounded-full flex items-center justify-center">
              @if(user.avatar)
              <img src="{{ user.avatar }}" alt="Avatar de {{ user.username }}"
                class="w-full h-full rounded-full object-cover" />
              @else
              <span class="text-white font-bold text-xs">{{ user.fullName ?
                user.fullName.charAt(0).toUpperCase() : user.username.charAt(0).toUpperCase() }}</span>
              @endif
            </div>
            <div class="flex-1 min-w-0">
              <div class="font-bold text-white text-sm truncate">
                {{ user.username }}
              </div>
              <div class="text-gray-400 text-xs truncate">
                {{ user.fullName || user.username }}
              </div>
            </div>
            <svg class="w-4 h-4 text-gray-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
              <path
                d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z" />
            </svg>
          </div>

          <!-- Bouton dÃ©connexion -->
          <div class="pb-2">
            <form action="/logout" method="POST" class="w-full">
              {{ csrfField() }}
              <button type="submit"
                class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded-full transition-all duration-200 flex items-center justify-center space-x-2 text-sm">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />

                </svg>
                <span>DÃ©connexion</span>
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Contenu principal -->
    <div class="flex-1 ml-64">
      <div class="flex">
        <!-- Timeline -->
        <div class="flex-1 max-w-2xl border-r border-gray-800">
          <!-- Messages flash -->
          @if(flashMessages.has('success'))
          <div class="bg-green-500 text-white px-4 py-3 mx-4 mt-4 rounded-lg flex items-center justify-between">
            <div class="flex items-center">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd" />

              </svg>
              <span>{{ flashMessages.get('success') }}</span>
            </div>
            <button onclick="this.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd" />

              </svg>
            </button>
          </div>
          @endif

          @if(flashMessages.has('error'))
          <div class="bg-red-500 text-white px-4 py-3 mx-4 mt-4 rounded-lg flex items-center justify-between">
            <div class="flex items-center">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                  clip-rule="evenodd" />

              </svg>
              <span>{{ flashMessages.get('error') }}</span>
            </div>
            <button onclick="this.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd" />

              </svg>
            </button>
          </div>
          @endif

          <!-- Header avec onglets -->
          <div class="sticky top-0 bg-black bg-opacity-80 backdrop-blur-md border-b border-gray-800 z-10">
            <div class="flex">
              <div class="flex-1 text-center">
                <button class="w-full py-4 font-bold border-b-4 border-blue-500 text-white">Pour
                  toi</button>
              </div>
              <div class="flex-1 text-center">
                <button class="w-full py-4 text-gray-500 hover:text-white transition-colors">Suivant</button>
              </div>
            </div>
          </div>

          <!-- Zone de composition -->
          <div class="border-b border-gray-800 p-4">
            <form action="{{ route('tweets.store') }}" method="POST" id="tweetForm" enctype="multipart/form-data">
              {{ csrfField() }}
              <div class="flex space-x-4">
                <div
                  class="w-12 h-12 {{ user.avatar ? '' : 'bg-gradient-to-r from-pink-500 to-purple-600' }} rounded-full flex items-center justify-center flex-shrink-0">
                  @if(user.avatar)
                  <img src="{{ user.avatar }}" alt="Avatar de {{ user.username }}"
                    class="w-full h-full rounded-full object-cover" />
                  @else
                  <span class="text-white font-bold">{{ user.fullName ?
                    user.fullName.charAt(0).toUpperCase() : user.username.charAt(0).toUpperCase() }}</span>
                  @endif
                </div>
                <div class="flex-1">
                  <textarea name="content" id="tweetContent"
                    class="w-full bg-transparent text-xl placeholder-gray-500 resize-none outline-none text-white border-none"
                    placeholder="Quoi de neuf ?" rows="3" maxlength="280" required></textarea>

                  <!-- PrÃ©visualisation d'image -->
                  <div id="imagePreview" class="hidden mt-3 mb-3">
                    <div class="relative">
                      <img id="previewImg" src="" alt="AperÃ§u de l'image"
                        class="rounded-2xl max-w-full h-auto max-h-64 border border-gray-700" />
                      <button type="button" id="removeImage"
                        class="absolute top-2 right-2 bg-gray-900 bg-opacity-75 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-100 transition-all">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />

                        </svg>
                      </button>
                    </div>
                  </div>

                  <div id="charCount" class="text-sm text-gray-500 text-right mt-1">
                    0 / 280
                  </div>

                  <!-- Boutons d'outils -->
                  <div class="flex items-center justify-between mt-4">
                    <div class="flex space-x-4 text-blue-500">
                      <label for="imageInput"
                        class="hover:bg-blue-500 hover:bg-opacity-10 p-2 rounded-full transition-all duration-200 cursor-pointer">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                          <path
                            d="M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2h-3zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8h-3zM5 19l3-4 2 3 3-4 4 5H5z" />
                        </svg>
                        <input type="file" id="imageInput" name="image" accept="image/*" class="hidden" />
                      </label>
                      <button type="button"
                        class="hover:bg-blue-500 hover:bg-opacity-10 p-2 rounded-full transition-all duration-200">ğŸ“Š</button>
                      <button type="button" id="grokButton"
                        class="hover:bg-purple-500 hover:bg-opacity-10 p-2 rounded-full transition-all duration-200 text-purple-400"
                        title="Aide Grok AI">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                          <path
                            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                        </svg>
                      </button>
                      <div class="relative">
                        <button type="button" id="emojiButton"
                          class="hover:bg-blue-500 hover:bg-opacity-10 p-2 rounded-full transition-all duration-200">ğŸ˜Š</button>
                        <!-- SÃ©lecteur d'emojis -->
                        <div id="emojiPicker"
                          class="absolute bottom-12 left-0 bg-gray-800 border-2 border-gray-600 rounded-xl p-4 hidden z-50 shadow-2xl backdrop-blur-sm">
                          <div class="bg-gray-900 rounded-lg p-2 mb-2">
                            <h3 class="text-white text-sm font-semibold text-center">
                              Choisir
                              un emoji
                            </h3>
                          </div>
                          <div class="grid grid-cols-6 gap-1 max-w-sm max-h-48 overflow-y-auto">
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜€</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜ƒ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜„</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜Š</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜‡</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ™‚</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ™ƒ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜‰</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜Œ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¥°</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜—</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜š</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜‹</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜›</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜œ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤ª</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤¨</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ§</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤“</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤©</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¥³</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜’</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜”</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜Ÿ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜•</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜¹ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜£</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜–</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜«</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜©</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¥º</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜¢</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜­</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜¤</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜ </button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜¡</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤¬</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤¯</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜³</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¥µ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¥¶</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜±</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜¨</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜°</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜¥</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜“</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤—</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤”</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤­</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤«</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¥´</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜µ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤ </button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¥¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ˜ˆ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘¿</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘Œ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">âœŒï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤Ÿ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘ˆ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘‰</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘†</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘‡</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">âœ‹</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤š</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ–ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ––</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘‹</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ‘</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ™Œ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’ª</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ”¥</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’¯</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â¤ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’š</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’›</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ§¡</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’œ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ–¤</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ¤</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’”</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â£ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’•</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’–</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’—</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’˜</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’Ÿ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜®ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">âœï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜ªï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ•‰ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜¸ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">âœ¡ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ”¯</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ•</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜¯ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜¦ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ›</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â›</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™ˆ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™‰</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™Š</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™‹</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™Œ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™‘</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™’</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â™“</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ†”</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">âš¡</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’¥</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸ’«</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â­</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸŒŸ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">âœ¨</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸŒ™</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜€ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸŒˆ</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â›…</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â›ˆï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸŒ©ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">ğŸŒ¨ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â„ï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â˜ƒï¸</button>
                            <button type="button"
                              class="emoji-btn text-3xl hover:bg-gray-600 hover:scale-110 p-3 rounded-lg transition-all duration-200 bg-gray-700">â›„</button>
                          </div>
                        </div>
                      </div>
                      <button type="button"
                        class="hover:bg-blue-500 hover:bg-opacity-10 p-2 rounded-full transition-all duration-200">ğŸ“</button>
                    </div>
                    <button type="submit" id="tweetButton"
                      class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-8 rounded-full transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                      disabled>
                      Poster
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>

          <!-- Feed de tweets -->
          @if(tweets && tweets.length > 0)
          @each(tweet in tweets)
          <article
            class="p-4 hover:bg-gray-950 hover:bg-opacity-50 transition-all duration-200 border-b border-gray-800">
            <div class="flex space-x-3">
              <!-- Avatar de l'utilisateur -->
              <div
                class="w-12 h-12 {{ tweet.user.avatar ? '' : 'bg-gradient-to-r from-blue-500 to-purple-600' }} rounded-full flex items-center justify-center flex-shrink-0 border-2 border-gray-600">
                @if(tweet.user.avatar)
                <img src="{{ tweet.user.avatar }}" alt="Avatar de {{ tweet.user.username }}"
                  class="w-full h-full rounded-full object-cover" />
                @else
                <span class="text-white font-bold text-lg">
                  {{ tweet.user.fullName ? tweet.user.fullName.charAt(0).toUpperCase() :
                  tweet.user.username.charAt(0).toUpperCase() }}
                </span>
                @endif
              </div>

              <div class="flex-1">
                <!-- Informations de l'utilisateur -->
                <div class="flex items-center space-x-2 mb-2">
                  <h3 class="font-bold text-white">
                    {{ tweet.user.fullName || tweet.user.username }}
                  </h3>
                  @if(tweet.user.verified)
                  <svg class="w-5 h-5 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                    <path
                      d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                  </svg>
                  @endif
                  <span class="text-gray-500">@{{ tweet.user.username }}</span>
                  <span class="text-gray-500">Â·</span>
                  <span class="text-gray-500">{{ tweet.createdAt.toFormat('dd/MM/yyyy HH:mm') }}</span>
                </div>

                <!-- Contenu du tweet avec hashtags formatÃ©s -->
                <div class="text-white text-base leading-relaxed mb-3">
                  {{{ tweet.formattedContent || tweet.content }}}
                </div>

                <!-- Image du tweet (si prÃ©sente) -->
                @if(tweet.imageUrl && tweet.imageUrl.trim() !== '')
                <div class="mb-3">
                  @if(tweet.imageUrl.startsWith('http'))
                  <!-- Image externe (URL complÃ¨te) -->
                  <img src="{{ tweet.imageUrl }}" alt="Image du tweet"
                    class="rounded-2xl max-w-full h-auto border border-gray-700 cursor-pointer hover:opacity-90 transition-opacity"
                    onerror="this.style.display='none';" />
                  @else
                  <!-- Image locale stockÃ©e -->
                  <img src="/uploads/{{ tweet.imageUrl }}" alt="Image du tweet"
                    class="rounded-2xl max-w-full h-auto border border-gray-700 cursor-pointer hover:opacity-90 transition-opacity"
                    onerror="this.style.display='none';" />
                  @endif
                </div>
                @endif

                <!-- Actions du tweet -->
                <div class="flex items-center justify-between max-w-md text-gray-500">
                  <!-- RÃ©pondre -->
                  <button class="reply-btn flex items-center space-x-2 hover:text-blue-500 transition-colors group"
                    data-tweet-id="{{ tweet.id }}">
                    <div class="p-2 rounded-full group-hover:bg-blue-500 group-hover:bg-opacity-10 transition-all">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />

                      </svg>
                    </div>
                    <span class="replies-count text-sm">{{ tweet.repliesCount > 0 ?
                      tweet.repliesCount : '' }}</span>
                  </button>

                  <!-- Retweet -->
                  <button class="retweet-btn flex items-center space-x-2 hover:text-green-500 transition-colors group"
                    data-tweet-id="{{ tweet.id }}">
                    <div class="p-2 rounded-full group-hover:bg-green-500 group-hover:bg-opacity-10 transition-all">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />

                      </svg>
                    </div>
                    <span class="retweets-count text-sm">{{ tweet.retweetsCount > 0 ?
                      tweet.retweetsCount : '' }}</span>
                  </button>

                  <!-- Like -->
                  <button class="like-btn flex items-center space-x-2 hover:text-red-500 transition-colors group"
                    data-tweet-id="{{ tweet.id }}">
                    <div class="p-2 rounded-full group-hover:bg-red-500 group-hover:bg-opacity-10 transition-all">
                      <svg class="w-5 h-5 heart-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />

                      </svg>
                    </div>
                    <span class="likes-count text-sm">{{ tweet.likesCount > 0 ? tweet.likesCount :
                      '' }}</span>
                  </button>

                  <!-- Partager -->
                  <button class="flex items-center space-x-2 hover:text-blue-500 transition-colors group">
                    <div class="p-2 rounded-full group-hover:bg-blue-500 group-hover:bg-opacity-10 transition-all">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" />

                      </svg>
                    </div>
                  </button>

                  <!-- Supprimer (seulement pour ses propres tweets) -->
                  @if(tweet.userId === user.id)
                  <button
                    class="delete-tweet-btn flex items-center space-x-2 hover:text-red-500 transition-colors group"
                    data-tweet-id="{{ tweet.id }}" title="Supprimer ce tweet">
                    <div class="p-2 rounded-full group-hover:bg-red-500 group-hover:bg-opacity-10 transition-all">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />

                      </svg>
                    </div>
                  </button>
                  @endif
                </div>
              </div>
            </div>
          </article>
          @endeach
          @else
          <!-- Message si pas de tweets -->
          <div class="text-center py-16">
            <div class="text-gray-500 text-6xl mb-4">
              ğŸ¦
            </div>
            <h2 class="text-2xl font-bold text-white mb-2">
              Bienvenue sur X !
            </h2>
            <p class="text-gray-500 mb-6">
              Quand des utilisateurs posteront des tweets, ils apparaÃ®tront ici.
            </p>
          </div>
          @endif
        </div>

        <!-- Sidebar droite -->
        <div class="w-80 p-4 space-y-4">
          <!-- Recherche -->
          <form action="/search" method="GET" class="relative">
            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
              <svg class="h-5 w-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
            </div>
            <input type="search" name="q" placeholder="Rechercher des utilisateurs et des tweets..."
              class="w-full bg-gray-900 text-white rounded-full py-3 pl-12 pr-4 outline-none focus:ring-2 focus:ring-blue-500 transition-all" />
          </form>

          <!-- Subscribe to Premium -->
          <div class="bg-gray-900 rounded-2xl p-4">
            <h2 class="text-xl font-bold text-white mb-2">
              Subscribe to Premium
            </h2>
            <p class="text-gray-400 text-sm mb-4">
              Subscribe to unlock new features and if eligible, receive
              a share of revenue.
            </p>
            <button class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-all">
              Subscribe
            </button>
          </div>

          <!-- What's happening -->
          <div class="bg-gray-900 rounded-2xl p-4">
            <h2 class="text-xl font-bold text-white mb-4">
              What's happening
            </h2>
            <div class="space-y-3">
              <div class="hover:bg-gray-800 p-2 rounded transition-all cursor-pointer">
                <div class="text-gray-500 text-xs">
                  Trending in Congo - Kinshasa
                </div>
                <div class="font-bold text-white">
                  Distraction
                </div>
                <div class="text-gray-500 text-xs">
                  29.1K posts
                </div>
              </div>
              <div class="hover:bg-gray-800 p-2 rounded transition-all cursor-pointer">
                <div class="text-gray-500 text-xs">
                  Trending in Congo - Kinshasa
                </div>
                <div class="font-bold text-white">
                  Rwandan
                </div>
                <div class="text-gray-500 text-xs">
                  2,013 posts
                </div>
              </div>
              <div class="hover:bg-gray-800 p-2 rounded transition-all cursor-pointer">
                <div class="text-gray-500 text-xs">
                  Trending
                </div>
                <div class="font-bold text-white">
                  Kinshasa
                </div>
                <div class="text-gray-500 text-xs">
                  5,025 posts
                </div>
              </div>
            </div>
            <button class="text-blue-500 hover:underline text-sm mt-3">Show more</button>
          </div>

          <!-- Who to follow -->
          @if(suggestedUsers && suggestedUsers.length > 0)
          <div class="bg-gray-900 rounded-2xl p-4">
            <h2 class="text-xl font-bold text-white mb-4">
              Suggestions pour vous
            </h2>
            <div class="space-y-3">
              @each(suggestedUser in suggestedUsers)
              <div class="flex items-center justify-between hover:bg-gray-800 p-2 rounded transition-all">
                <div class="flex items-center space-x-3">
                  <div
                    class="w-10 h-10 {{ suggestedUser.avatar ? '' : 'bg-gradient-to-r from-blue-500 to-purple-600' }} rounded-full flex items-center justify-center border border-gray-600">
                    @if(suggestedUser.avatar)
                    <img src="{{ suggestedUser.avatar }}" alt="Avatar de {{ suggestedUser.username }}"
                      class="w-full h-full rounded-full object-cover" />
                    @else
                    <span class="text-white font-bold text-sm">
                      {{ suggestedUser.fullName ? suggestedUser.fullName.charAt(0).toUpperCase() :
                      suggestedUser.username.charAt(0).toUpperCase() }}
                    </span>
                    @endif
                  </div>
                  <div>
                    <div class="flex items-center space-x-1">
                      <span class="font-bold text-white text-sm">{{ suggestedUser.fullName ||
                        suggestedUser.username }}</span>
                      @if(suggestedUser.verified)
                      <svg class="w-4 h-4 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                        <path
                          d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                      </svg>
                      @endif
                    </div>
                    <div class="text-gray-500 text-xs">
                      @{{ suggestedUser.username }}
                    </div>
                    @if(suggestedUser.tweetsCount > 0)
                    <div class="text-gray-500 text-xs">
                      {{ suggestedUser.tweetsCount }} tweets
                    </div>
                    @endif
                  </div>
                </div>
                <button
                  class="follow-btn bg-white hover:bg-gray-200 text-black font-bold py-1 px-4 rounded-full text-sm transition-all"
                  data-user-id="{{ suggestedUser.id }}">
                  Suivre
                </button>
              </div>
              @endeach
            </div>
            <button class="text-blue-500 hover:underline text-sm mt-3">Voir plus</button>
          </div>
          @endif

          <!-- Footer -->
          <div class="bg-gray-900 rounded-2xl p-4 mt-4">
            <div class="space-y-4">
              <div>
                <h3 class="font-bold text-white mb-2">
                  Ã€ propos
                </h3>
                <div class="space-y-1 text-gray-400 text-xs">
                  <a href="#" class="block hover:text-white transition-colors">Centre d'aide</a>
                  <a href="#" class="block hover:text-white transition-colors">Conditions
                    d'utilisation</a>
                  <a href="#" class="block hover:text-white transition-colors">Politique de
                    confidentialitÃ©</a>
                </div>
              </div>

              <div class="border-t border-gray-700 pt-3">
                <div class="flex items-center justify-between text-xs">
                  <div class="flex items-center space-x-1">
                    <svg class="w-4 h-4 fill-white" viewBox="0 0 24 24">
                      <path
                        d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
                    </svg>
                    <span class="text-gray-400">Â© 2025 X Corp.</span>
                  </div>
                </div>
                <div class="text-gray-400 text-xs mt-1">
                  DÃ©veloppÃ© avec â¤ï¸ par Marina Keet
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal des notifications -->
  <div id="notificationsModal"
    class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-gray-900 rounded-2xl p-6 max-w-md w-full mx-4 max-h-96 overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold text-white">
          Notifications
        </h2>
        <div class="flex items-center space-x-2">
          <button id="markAllReadBtn"
            class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-3 py-1 rounded-full transition-colors">
            Tout marquer comme lu
          </button>
          <button id="closeNotificationsModal" class="text-gray-400 hover:text-white">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />

            </svg>
          </button>
        </div>
      </div>
      <div id="notificationsList" class="space-y-3">
        <p class="text-gray-400 text-center">
          Chargement des notifications...
        </p>
      </div>
    </div>
  </div>

  <!-- Modal Grok AI -->
  <div id="grokModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-gray-900 rounded-2xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-6">
        <div class="flex items-center space-x-3">
          <div
            class="w-8 h-8 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
            </svg>
          </div>
          <h2 class="text-xl font-bold text-white">Assistant Grok AI</h2>
        </div>
        <button id="closeGrokModal" class="text-gray-400 hover:text-white">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Onglets Grok -->
      <div class="flex space-x-2 mb-6 bg-gray-800 rounded-lg p-1">
        <button class="grok-tab active px-4 py-2 rounded-md text-sm font-medium transition-colors" data-tab="generate">
          GÃ©nÃ©rer contenu
        </button>
        <button class="grok-tab px-4 py-2 rounded-md text-sm font-medium transition-colors" data-tab="hashtags">
          SuggÃ©rer hashtags
        </button>
        <button class="grok-tab px-4 py-2 rounded-md text-sm font-medium transition-colors" data-tab="analyze">
          Analyser tweet
        </button>
        <button class="grok-tab px-4 py-2 rounded-md text-sm font-medium transition-colors" data-tab="optimize">
          Optimiser
        </button>
      </div>

      <!-- Contenu des onglets -->
      <div id="grokContent">

        <!-- Onglet GÃ©nÃ©rer contenu -->
        <div id="grok-generate" class="grok-tab-content">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">IdÃ©e ou sujet :</label>
              <textarea id="generatePrompt"
                class="w-full bg-gray-800 text-white rounded-lg p-3 border border-gray-700 focus:border-purple-500 focus:outline-none resize-none"
                placeholder="DÃ©crivez votre idÃ©e ou le sujet sur lequel vous voulez tweeter..." rows="3"></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Ton :</label>
              <select id="generateTone"
                class="w-full bg-gray-800 text-white rounded-lg p-3 border border-gray-700 focus:border-purple-500 focus:outline-none">
                <option value="casual">DÃ©contractÃ©</option>
                <option value="professional">Professionnel</option>
                <option value="humorous">Humoristique</option>
                <option value="inspirational">Inspirant</option>
              </select>
            </div>
            <button id="generateContentBtn"
              class="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white py-3 rounded-lg hover:opacity-90 transition-opacity font-medium">
              âœ¨ GÃ©nÃ©rer du contenu
            </button>
            <div id="generatedResults" class="hidden space-y-3">
              <h4 class="font-medium text-white">Suggestions gÃ©nÃ©rÃ©es :</h4>
              <div id="generatedSuggestions" class="space-y-2"></div>
            </div>
          </div>
        </div>

        <!-- Onglet SuggÃ©rer hashtags -->
        <div id="grok-hashtags" class="grok-tab-content hidden">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Contenu du tweet :</label>
              <textarea id="hashtagContent"
                class="w-full bg-gray-800 text-white rounded-lg p-3 border border-gray-700 focus:border-purple-500 focus:outline-none resize-none"
                placeholder="Collez votre tweet ici pour obtenir des suggestions de hashtags..." rows="3"></textarea>
            </div>
            <div class="flex items-center space-x-4">
              <button id="useCurrentTweet" class="text-purple-400 hover:text-purple-300 text-sm underline">
                Utiliser le tweet actuel
              </button>
              <label class="text-sm text-gray-300">
                Nombre max :
                <input type="number" id="maxHashtags" value="5" min="1" max="10"
                  class="w-16 bg-gray-800 text-white rounded px-2 py-1 border border-gray-700">
              </label>
            </div>
            <button id="suggestHashtagsBtn"
              class="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white py-3 rounded-lg hover:opacity-90 transition-opacity font-medium">
              ğŸ·ï¸ SuggÃ©rer des hashtags
            </button>
            <div id="hashtagResults" class="hidden space-y-3">
              <h4 class="font-medium text-white">Hashtags suggÃ©rÃ©s :</h4>
              <div id="hashtagSuggestions" class="space-y-2"></div>
            </div>
          </div>
        </div>

        <!-- Onglet Analyser tweet -->
        <div id="grok-analyze" class="grok-tab-content hidden">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Tweet Ã  analyser :</label>
              <textarea id="analyzeContent"
                class="w-full bg-gray-800 text-white rounded-lg p-3 border border-gray-700 focus:border-purple-500 focus:outline-none resize-none"
                placeholder="Collez le tweet que vous voulez analyser..." rows="3"></textarea>
            </div>
            <button id="useCurrentTweetAnalyze" class="text-purple-400 hover:text-purple-300 text-sm underline">
              Utiliser le tweet actuel
            </button>
            <button id="analyzeTweetBtn"
              class="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white py-3 rounded-lg hover:opacity-90 transition-opacity font-medium">
              ğŸ“Š Analyser le tweet
            </button>
            <div id="analyzeResults" class="hidden space-y-4">
              <h4 class="font-medium text-white">Analyse :</h4>
              <div id="analyzeDetails" class="space-y-3"></div>
            </div>
          </div>
        </div>

        <!-- Onglet Optimiser -->
        <div id="grok-optimize" class="grok-tab-content hidden">
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Tweet Ã  optimiser :</label>
              <textarea id="optimizeContent"
                class="w-full bg-gray-800 text-white rounded-lg p-3 border border-gray-700 focus:border-purple-500 focus:outline-none resize-none"
                placeholder="Collez le tweet que vous voulez optimiser..." rows="3"></textarea>
            </div>
            <button id="useCurrentTweetOptimize" class="text-purple-400 hover:text-purple-300 text-sm underline">
              Utiliser le tweet actuel
            </button>
            <button id="optimizeTweetBtn"
              class="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white py-3 rounded-lg hover:opacity-90 transition-opacity font-medium">
              ğŸš€ Optimiser le tweet
            </button>
            <div id="optimizeResults" class="hidden space-y-4">
              <h4 class="font-medium text-white">Optimisations suggÃ©rÃ©es :</h4>
              <div id="optimizeDetails" class="space-y-3"></div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    console.log("ğŸš€ Script JavaScript chargÃ© !");

    function toggleThemeSelector() {
      const selector = document.getElementById("themeSelector");
      selector.classList.toggle("hidden");
    }

    function toggleMoreMenu() {
      const menu = document.getElementById("moreMenu");
      menu.classList.toggle("hidden");
    }

    function focusTweetComposer() {
      const tweetContent = document.getElementById("tweetContent");
      if (tweetContent) {
        // Faire dÃ©filer jusqu'au formulaire de tweet
        tweetContent.scrollIntoView({
          behavior: "smooth",
          block: "center"
        });
        // Mettre le focus sur le textarea avec un petit dÃ©lai pour l'animation
        setTimeout(() => {
          tweetContent.focus();
          // Ajouter un effet visuel temporaire
          tweetContent.style.boxShadow = "0 0 0 2px #1da1f2";
          setTimeout(() => {
            tweetContent.style.boxShadow = "";
          }, 2e3);
        }, 500);
      }
    }
    // Fermer les menus si on clique ailleurs

    document.addEventListener("click", function (event) {
      const selector = document.getElementById("themeSelector");
      const moreMenu = document.getElementById("moreMenu");
      const themeButton = event.target.closest('[onclick="toggleThemeSelector()"]');
      const moreButton = event.target.closest('[onclick="toggleMoreMenu()"]');
      // Fermer le sÃ©lecteur de thÃ¨me
      if (!themeButton && !selector.classList.contains("hidden")) {
        selector.classList.add("hidden");
      }
      // Fermer le menu "Plus"
      if (!moreButton && moreMenu && !moreMenu.contains(event.target) && !moreMenu.classList.contains("hidden")) {
        moreMenu.classList.add("hidden");
      }
    });
    // Gestion du formulaire de tweet

    document.addEventListener("DOMContentLoaded", function () {
      console.log("ğŸ“„ DOM chargÃ©, initialisation des Ã©lÃ©ments...");
      const tweetContent = document.getElementById("tweetContent");
      const charCount = document.getElementById("charCount");
      const tweetButton = document.getElementById("tweetButton");
      const tweetForm = document.getElementById("tweetForm");
      console.log("ğŸ” Ã‰lÃ©ments trouvÃ©s:", {
        tweetContent: !!tweetContent,
        charCount: !!charCount,
        tweetButton: !!tweetButton,
        tweetForm: !!tweetForm
      });
      // Mise Ã  jour du compteur de caractÃ¨res
      tweetContent.addEventListener("input", function () {
        const currentLength = this.value.length;
        charCount.textContent = `${currentLength} / 280`;
        // Activer/dÃ©sactiver le bouton selon la longueur
        if (currentLength > 0 && currentLength <= 280) {
          tweetButton.disabled = false;
          tweetButton.classList.remove("opacity-50", "cursor-not-allowed");
        } else {
          tweetButton.disabled = true;
          tweetButton.classList.add("opacity-50", "cursor-not-allowed");
        }
        // Changer la couleur selon la longueur
        if (currentLength > 260) {
          charCount.classList.add("text-red-500");
          charCount.classList.remove("text-gray-500", "text-yellow-500");
        } else if (currentLength > 240) {
          charCount.classList.add("text-yellow-500");
          charCount.classList.remove("text-gray-500", "text-red-500");
        } else {
          charCount.classList.add("text-gray-500");
          charCount.classList.remove("text-yellow-500", "text-red-500");
        }
      });
      // Gestion de la soumission du formulaire
      tweetForm.addEventListener("submit", function (e) {
        const content = tweetContent.value.trim();
        if (!content || content.length > 280) {
          e.preventDefault();
          alert("Veuillez saisir un contenu valide (1-280 caractÃ¨res)");
          return;
        }
        // DÃ©sactiver le bouton pour Ã©viter les doubles soumissions
        tweetButton.disabled = true;
        tweetButton.textContent = "Publication...";
      });
      // Gestion de la prÃ©visualisation d'image
      const imageInput = document.getElementById("imageInput");
      const imagePreview = document.getElementById("imagePreview");
      const previewImg = document.getElementById("previewImg");
      const removeImageBtn = document.getElementById("removeImage");
      imageInput.addEventListener("change", function (e) {
        const file = e.target.files[0];
        if (file) {
          // VÃ©rifier si c'est une image
          if (!file.type.startsWith("image/")) {
            alert("Veuillez sÃ©lectionner un fichier image valide.");
            imageInput.value = "";
            return;
          }
          // VÃ©rifier la taille du fichier (max 5MB)
          if (file.size > 5 * 1024 * 1024) {
            alert("La taille de l'image ne doit pas dÃ©passer 5MB.");
            imageInput.value = "";
            return;
          }
          // CrÃ©er l'URL de prÃ©visualisation
          const reader = new FileReader();
          reader.onload = function (e) {
            previewImg.src = e.target.result;
            imagePreview.classList.remove("hidden");
          };
          reader.readAsDataURL(file);
        }
      });
      // Supprimer l'image sÃ©lectionnÃ©e
      removeImageBtn.addEventListener("click", function () {
        imageInput.value = "";
        imagePreview.classList.add("hidden");
        previewImg.src = "";
      });
      // Gestion du sÃ©lecteur d'emojis
      const emojiButton = document.getElementById("emojiButton");
      const emojiPicker = document.getElementById("emojiPicker");
      const emojiButtons = document.querySelectorAll(".emoji-btn");
      // Toggle du sÃ©lecteur d'emojis
      emojiButton.addEventListener("click", function (e) {
        e.preventDefault();
        e.stopPropagation();
        emojiPicker.classList.toggle("hidden");
      });
      // Fermer le sÃ©lecteur si on clique ailleurs
      document.addEventListener("click", function (e) {
        if (!emojiPicker.contains(e.target) && e.target !== emojiButton) {
          emojiPicker.classList.add("hidden");
        }
      });
      // Ajouter les emojis au textarea
      emojiButtons.forEach(button => {
        button.addEventListener("click", function (e) {
          e.preventDefault();
          const emoji = this.textContent;
          const cursorPosition = tweetContent.selectionStart;
          const textBefore = tweetContent.value.substring(0, cursorPosition);
          const textAfter = tweetContent.value.substring(cursorPosition);
          // VÃ©rifier si l'ajout de l'emoji ne dÃ©passe pas la limite
          if (tweetContent.value.length + emoji.length <= 280) {
            tweetContent.value = textBefore + emoji + textAfter;
            tweetContent.focus();
            tweetContent.setSelectionRange(cursorPosition + emoji.length, cursorPosition + emoji.length);
            // DÃ©clencher l'Ã©vÃ©nement input pour mettre Ã  jour le compteur
            const event = new Event("input", {
              bubbles: true
            });
            tweetContent.dispatchEvent(event);
          }
          // Fermer le sÃ©lecteur aprÃ¨s sÃ©lection
          emojiPicker.classList.add("hidden");
        });
      });
      // Gestion des interactions avec les tweets (likes et retweets)
      // Gestion des likes
      const likeButtons = document.querySelectorAll(".like-btn");
      console.log(`ğŸ’– Boutons like trouvÃ©s: ${likeButtons.length}`);
      likeButtons.forEach(button => {
        button.addEventListener("click", async function () {
          const tweetId = this.dataset.tweetId;
          const heartIcon = this.querySelector(".heart-icon");
          const likesCount = this.querySelector(".likes-count");
          console.log(`ğŸ‘† Clic sur like pour tweet ${tweetId}`);
          console.log("Ã‰lÃ©ments trouvÃ©s:", {
            heartIcon: !!heartIcon,
            likesCount: !!likesCount
          });
          try {
            const response = await fetch(`/tweets/${tweetId}/like`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
                "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
              }
            });
            if (response.ok) {
              const data = await response.json();
              console.log(`ğŸ¯ RÃ©ponse like tweet ${tweetId}:`, data);
              // Mettre Ã  jour l'apparence du bouton
              if (data.status === "liked") {
                console.log(`â¤ï¸ Tweet ${tweetId} likÃ© - ajout classe rouge`);
                this.classList.add("text-red-500");
                if (heartIcon) heartIcon.setAttribute("fill", "currentColor");
              } else {
                console.log(`ğŸ¤ Tweet ${tweetId} unlikÃ© - retrait classe rouge`);
                this.classList.remove("text-red-500");
                if (heartIcon) heartIcon.setAttribute("fill", "none");
              }
              // Mettre Ã  jour le compteur
              if (likesCount) {
                likesCount.textContent = data.likesCount > 0 ? data.likesCount : "";
                console.log(`ğŸ“Š Compteur likes mis Ã  jour: ${data.likesCount}`);
              }
            } else {
              console.error(`âŒ Erreur HTTP pour tweet ${tweetId}:`, response.status);
            }
          } catch (error) {
            console.error("Erreur lors du like:", error);
          }
        });
      });
      // Gestion des retweets
      document.querySelectorAll(".retweet-btn").forEach(button => {
        button.addEventListener("click", async function () {
          const tweetId = this.dataset.tweetId;
          const retweetsCount = this.querySelector(".retweets-count");
          // Demander confirmation et optionnellement un commentaire
          const comment = prompt("Voulez-vous ajouter un commentaire Ã  ce retweet ? (Optionnel)");
          if (comment === null) {
            return; // L'utilisateur a annulÃ©
          }
          try {
            const response = await fetch(`/tweets/${tweetId}/retweet`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
                "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
              },
              body: JSON.stringify({
                comment: comment.trim() || null
              })
            });
            if (response.ok) {
              const data = await response.json();
              // Mettre Ã  jour l'apparence du bouton
              this.classList.add("text-green-500");
              // Mettre Ã  jour le compteur
              retweetsCount.textContent = data.retweetsCount > 0 ? data.retweetsCount : "";
              // DÃ©sactiver le bouton pour Ã©viter les doublons
              this.disabled = true;
              this.style.opacity = "0.5";
            } else {
              const error = await response.json();
              alert(error.error || "Erreur lors du retweet");
            }
          } catch (error) {
            console.error("Erreur lors du retweet:", error);
            alert("Erreur lors du retweet");
          }
        });
      });
      // Initialiser l'Ã©tat des boutons d'interaction au chargement
      async function initializeInteractionButtons() {
        const likeBtns = document.querySelectorAll(".like-btn");
        console.log(`ğŸ”„ Initialisation de ${likeBtns.length} boutons like`);
        for (const button of likeBtns) {
          const tweetId = button.dataset.tweetId;
          if (tweetId) {
            try {
              console.log(`ğŸ“‹ Chargement des interactions pour tweet ${tweetId}`);
              const response = await fetch(`/tweets/${tweetId}/interactions`, {
                headers: {
                  Accept: "application/json",
                  "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
                }
              });
              if (response.ok) {
                const data = await response.json();
                console.log(`âœ… Interactions tweet ${tweetId}:`, data);
                // Mettre Ã  jour l'Ã©tat des likes
                if (data.hasLiked) {
                  console.log(`â¤ï¸ Tweet ${tweetId} dÃ©jÃ  likÃ© - mise Ã  jour du bouton`);
                  button.classList.add("text-red-500");
                  const heartIcon = button.querySelector(".heart-icon");
                  if (heartIcon) heartIcon.setAttribute("fill", "currentColor");
                } else {
                  console.log(`ğŸ¤ Tweet ${tweetId} pas encore likÃ©`);
                }
                // Mettre Ã  jour l'Ã©tat des retweets
                const retweetBtn = button.parentElement.querySelector(".retweet-btn");
                if (retweetBtn && data.hasRetweeted) {
                  retweetBtn.classList.add("text-green-500");
                }
              }
            } catch (error) {
              console.error("Erreur lors de l'initialisation des interactions:", error);
            }
          }
        }
      }
      // Appeler l'initialisation aprÃ¨s un court dÃ©lai pour s'assurer que le DOM est prÃªt
      setTimeout(initializeInteractionButtons, 100);
      // Gestion des boutons de suivi
      document.querySelectorAll(".follow-btn").forEach(button => {
        button.addEventListener("click", async function () {
          const userId = this.dataset.userId;
          try {
            const response = await fetch(`/users/${userId}/follow`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
                "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
              }
            });
            if (response.ok) {
              const data = await response.json();
              // Mettre Ã  jour le bouton selon le statut
              if (data.status === "followed") {
                this.textContent = "Suivi(e)";
                this.classList.remove("bg-white", "hover:bg-gray-200", "text-black");
                this.classList.add("bg-gray-600", "text-white");
              } else if (data.status === "unfollowed") {
                this.textContent = "Suivre";
                this.classList.remove("bg-gray-600", "text-white");
                this.classList.add("bg-white", "hover:bg-gray-200", "text-black");
              }
              // Afficher un message de succÃ¨s
              console.log(data.message);
            } else {
              const error = await response.json();
              alert(error.error || "Erreur lors du suivi");
            }
          } catch (error) {
            console.error("Erreur lors du suivi:", error);
            alert("Erreur lors du suivi");
          }
        });
      });
      // Gestion des notifications
      const notificationsBtn = document.getElementById("notificationsBtn");
      const notificationsModal = document.getElementById("notificationsModal");
      const closeNotificationsModal = document.getElementById("closeNotificationsModal");
      const notificationsList = document.getElementById("notificationsList");
      const notificationBadge = document.getElementById("notificationBadge");
      // Ouvrir la modal des notifications
      notificationsBtn.addEventListener("click", async function () {
        notificationsModal.classList.remove("hidden");
        await loadNotifications();
      });
      // Fermer la modal
      closeNotificationsModal.addEventListener("click", function () {
        notificationsModal.classList.add("hidden");
      });
      // Fermer en cliquant en dehors
      notificationsModal.addEventListener("click", function (e) {
        if (e.target === notificationsModal) {
          notificationsModal.classList.add("hidden");
        }
      });
      // Charger les notifications
      async function loadNotifications() {
        try {
          const response = await fetch("/notifications", {
            headers: {
              Accept: "application/json",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            }
          });
          if (response.ok) {
            const data = await response.json();
            console.log("DonnÃ©es notifications reÃ§ues:", data); // Debug
            displayNotifications(data.notifications || []);
          } else {
            notificationsList.innerHTML = '<p class="text-red-400 text-center">Erreur lors du chargement</p>';
          }
        } catch (error) {
          console.error("Erreur notifications:", error);
          notificationsList.innerHTML = '<p class="text-red-400 text-center">Erreur de connexion</p>';
        }
      }
      // Fonction pour obtenir l'icÃ´ne selon le type de notification
      function getNotificationIcon(type) {
        switch (type) {
          case 'like':
            return '<div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg></div>';
          case 'follow':
            return '<div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg></div>';
          case 'retweet':
            return '<div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg></div>';
          case 'comment':
            return '<div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg></div>';
          case 'follow_request':
            return '<div class="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/></svg></div>';
          case 'follow_accepted':
            return '<div class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>';
          default:
            return '<div class="w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM4.868 3.303l5.657 5.657m0 0l5.657 5.657m0 0l5.657-5.657M4.868 19.317l5.657-5.657"/></svg></div>';
        }
      }
      // Afficher les notifications
      function displayNotifications(notifications) {
        if (notifications.length === 0) {
          notificationsList.innerHTML = '<p class="text-gray-400 text-center">Aucune notification</p>';
          return;
        }
        console.log("Notifications reÃ§ues:", notifications); // Debug
        notificationsList.innerHTML = notifications.map(notification => `
                                <div class="notification-item p-3 border border-gray-700 rounded-lg ${notification.isRead ? "bg-gray-800" : "bg-gray-700"} cursor-pointer hover:bg-gray-600 transition-colors" 
                                     data-notification-id="${notification.id}" 
                                     data-is-read="${notification.isRead}">
                                    <div class="flex items-start space-x-3">
                                        ${getNotificationIcon(notification.type)}
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-2 mb-1">
                                                <p class="text-white font-bold text-sm">${notification.fromUser?.fullName || notification.fromUser?.username || "Utilisateur inconnu"}</p>
                                                <span class="text-gray-400 text-xs">@${notification.fromUser?.username || "inconnu"}</span>
                                            </div>
                                            <p class="text-gray-300 text-sm">${notification.message}</p>
                                            <p class="text-gray-400 text-xs mt-1">${notification.createdAt}</p>
                                            ${!notification.isRead ? '<p class="text-blue-400 text-xs mt-2 font-medium">ğŸ“© Non lu - Cliquez pour marquer comme lu</p>' : '<p class="text-gray-500 text-xs mt-2">âœ… Lu</p>'}
                                        </div>
                                        ${!notification.isRead ? '<div class="w-2 h-2 bg-blue-500 rounded-full"></div>' : ""}
                                    </div>
                                </div>
                            `).join("");
        // Ajouter les gestionnaires de clic pour marquer comme lu
        document.querySelectorAll(".notification-item").forEach(item => {
          item.addEventListener("click", async function () {
            const notificationId = this.dataset.notificationId;
            const isRead = this.dataset.isRead === "true";
            if (!isRead) {
              await markNotificationAsRead(notificationId, this);
            }
          });
        });
        // Mettre Ã  jour le badge
        const unreadCount = notifications.filter(n => !n.isRead).length;
        if (unreadCount > 0) {
          notificationBadge.textContent = unreadCount;
          notificationBadge.classList.remove("hidden");
        } else {
          notificationBadge.classList.add("hidden");
        }
      }
      // Marquer une notification comme lue
      async function markNotificationAsRead(notificationId, notificationElement) {
        try {
          console.log(`ğŸ“– Marquage notification ${notificationId} comme lue`);
          const response = await fetch(`/notifications/${notificationId}/read`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Accept: "application/json",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            }
          });
          if (response.ok) {
            console.log(`âœ… Notification ${notificationId} marquÃ©e comme lue`);
            // Mettre Ã  jour visuellement la notification
            notificationElement.classList.remove("bg-gray-700");
            notificationElement.classList.add("bg-gray-800");
            notificationElement.dataset.isRead = "true";
            // Supprimer le point bleu et le texte "Non lu"
            const blueDot = notificationElement.querySelector(".bg-blue-500");
            if (blueDot) blueDot.remove();
            const unreadText = notificationElement.querySelector(".text-blue-400");
            if (unreadText) {
              unreadText.className = "text-gray-500 text-xs mt-2";
              unreadText.textContent = "âœ… Lu";
            }
            // Mettre Ã  jour le badge de notifications
            updateNotificationBadge();
          } else {
            console.error(`âŒ Erreur lors du marquage de la notification ${notificationId}`);
          }
        } catch (error) {
          console.error("Erreur lors du marquage comme lu:", error);
        }
      }
      // Mettre Ã  jour le badge de notifications
      function updateNotificationBadge() {
        const unreadNotifications = document.querySelectorAll('.notification-item[data-is-read="false"]');
        const unreadCount = unreadNotifications.length;
        if (unreadCount > 0) {
          notificationBadge.textContent = unreadCount;
          notificationBadge.classList.remove("hidden");
        } else {
          notificationBadge.classList.add("hidden");
        }
      }
      // Marquer toutes les notifications comme lues
      async function markAllNotificationsAsRead() {
        try {
          console.log("ğŸ“– Marquage de toutes les notifications comme lues");
          const response = await fetch("/notifications/mark-all-read", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Accept: "application/json",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            }
          });
          if (response.ok) {
            console.log("âœ… Toutes les notifications marquÃ©es comme lues");
            // Mettre Ã  jour visuellement toutes les notifications
            const unreadNotifications = document.querySelectorAll('.notification-item[data-is-read="false"]');
            unreadNotifications.forEach(notification => {
              notification.classList.remove("bg-gray-700");
              notification.classList.add("bg-gray-800");
              notification.dataset.isRead = "true";
              // Supprimer le point bleu
              const blueDot = notification.querySelector(".bg-blue-500");
              if (blueDot) blueDot.remove();
              // Mettre Ã  jour le texte de statut
              const unreadText = notification.querySelector(".text-blue-400");
              if (unreadText) {
                unreadText.className = "text-gray-500 text-xs mt-2";
                unreadText.textContent = "âœ… Lu";
              }
            });
            // Mettre Ã  jour le badge (doit Ãªtre 0)
            updateNotificationBadge();
            // Afficher un message de succÃ¨s
            const successMsg = document.createElement("div");
            successMsg.className = "fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded shadow z-50";
            successMsg.textContent = "Toutes les notifications marquÃ©es comme lues";
            document.body.appendChild(successMsg);
            setTimeout(() => successMsg.remove(), 3e3);
          } else {
            console.error("âŒ Erreur lors du marquage de toutes les notifications");
            alert("Erreur lors du marquage des notifications");
          }
        } catch (error) {
          console.error("ğŸš¨ Erreur lors du marquage de toutes les notifications:", error);
          alert("Erreur lors du marquage des notifications");
        }
      }
      // Gestionnaire pour le bouton "Tout marquer comme lu"
      document.addEventListener("click", function (e) {
        if (e.target.id === "markAllReadBtn") {
          e.preventDefault();
          markAllNotificationsAsRead();
        }
      });
      // Charger les notifications au dÃ©marrage pour le badge
      loadNotifications();
      // ==========================================================
      // GESTION DE LA SUPPRESSION DES TWEETS
      // ==========================================================
      // Gestionnaire pour les boutons de suppression de tweets
      document.addEventListener("click", function (e) {
        if (e.target.closest(".delete-tweet-btn")) {
          e.preventDefault();
          const btn = e.target.closest(".delete-tweet-btn");
          const tweetId = btn.dataset.tweetId;
          if (confirm("ÃŠtes-vous sÃ»r de vouloir supprimer ce tweet ? Cette action est irrÃ©versible.")) {
            deleteTweet(tweetId, btn);
          }
        }
      });
      // Fonction pour supprimer un tweet
      async function deleteTweet(tweetId, button) {
        try {
          button.disabled = true;
          button.style.opacity = "0.5";
          const response = await fetch(`/tweets/${tweetId}`, {
            method: "DELETE",
            headers: {
              "X-Requested-With": "XMLHttpRequest",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            }
          });
          const result = await response.json();
          if (response.ok && result.success) {
            // Supprimer l'article du DOM avec une animation
            const article = button.closest("article");
            article.style.transition = "opacity 0.3s ease-out, transform 0.3s ease-out";
            article.style.opacity = "0";
            article.style.transform = "translateX(-100%)";
            setTimeout(() => {
              article.remove();
            }, 300);
            // Afficher un message de succÃ¨s
            showSuccessMessage("Tweet supprimÃ© avec succÃ¨s !");
          } else {
            throw new Error(result.error || "Erreur lors de la suppression");
          }
        } catch (error) {
          console.error("Erreur lors de la suppression du tweet:", error);
          alert("Erreur lors de la suppression du tweet: " + error.message);
          // RÃ©activer le bouton en cas d'erreur
          button.disabled = false;
          button.style.opacity = "1";
        }
      }
      // ==========================================================
      // GESTION DES RÃ‰PONSES / COMMENTAIRES
      // ==========================================================
      // Gestionnaire pour les boutons de rÃ©ponse
      document.addEventListener("click", function (e) {
        if (e.target.closest(".reply-btn")) {
          e.preventDefault();
          const btn = e.target.closest(".reply-btn");
          const tweetId = btn.dataset.tweetId;
          showReplyModal(tweetId);
        }
      });
      // Afficher le modal de rÃ©ponse
      function showReplyModal(tweetId) {
        // CrÃ©er le modal s'il n'existe pas
        let modal = document.getElementById("replyModal");
        if (!modal) {
          modal = createReplyModal();
          document.body.appendChild(modal);
        }
        // Stocker l'ID du tweet dans le modal
        modal.dataset.tweetId = tweetId;
        // RÃ©initialiser le formulaire
        const textarea = modal.querySelector("#replyContent");
        const imageInput = modal.querySelector("#replyImage");
        textarea.value = "";
        imageInput.value = "";
        // Afficher le modal
        modal.classList.remove("hidden");
        textarea.focus();
      }
      // CrÃ©er le modal de rÃ©ponse
      function createReplyModal() {
        const modalHTML = `
                                <div id="replyModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                                    <div class="bg-gray-900 rounded-lg p-6 w-full max-w-lg mx-4">
                                        <div class="flex justify-between items-center mb-4">
                                            <h3 class="text-xl font-bold text-white">RÃ©pondre au tweet</h3>
                                            <button id="closeReplyModal" class="text-gray-400 hover:text-white">
                                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                                </svg>
                                            </button>
                                        </div>

                                        <form id="replyForm">
                                            <textarea 
                                                id="replyContent" 
                                                placeholder="Ã‰crivez votre rÃ©ponse..." 
                                                class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"
                                                rows="4"
                                                maxlength="280"
                                                required></textarea>

                                            <div class="flex items-center justify-between mt-4">
                                                <div class="flex items-center space-x-4">
                                                    <label for="replyImage" class="cursor-pointer text-blue-400 hover:text-blue-300">
                                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                                        </svg>
                                                    </label>
                                                    <input type="file" id="replyImage" accept="image/*" class="hidden">
                                                    <div id="replyCharCount" class="text-sm text-gray-400">0/280</div>
                                                </div>

                                                <div class="flex space-x-3">
                                                    <button type="button" id="cancelReply" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                                                        Annuler
                                                    </button>
                                                    <button type="submit" id="submitReply" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                                        RÃ©pondre
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            `;
        const wrapper = document.createElement("div");
        wrapper.innerHTML = modalHTML;
        const modal = wrapper.firstElementChild;
        // Gestionnaires d'Ã©vÃ©nements pour le modal
        setupReplyModalEvents(modal);
        return modal;
      }
      // Configuration des Ã©vÃ©nements du modal de rÃ©ponse
      function setupReplyModalEvents(modal) {
        const closeBtn = modal.querySelector("#closeReplyModal");
        const cancelBtn = modal.querySelector("#cancelReply");
        const form = modal.querySelector("#replyForm");
        const textarea = modal.querySelector("#replyContent");
        const charCount = modal.querySelector("#replyCharCount");
        // Fermer le modal
        closeBtn.addEventListener("click", () => modal.classList.add("hidden"));
        cancelBtn.addEventListener("click", () => modal.classList.add("hidden"));
        // Fermer en cliquant Ã  l'extÃ©rieur
        modal.addEventListener("click", e => {
          if (e.target === modal) modal.classList.add("hidden");
        });
        // Compteur de caractÃ¨res
        textarea.addEventListener("input", () => {
          const count = textarea.value.length;
          charCount.textContent = `${count}/280`;
          charCount.classList.toggle("text-red-400", count > 280);
        });
        // Soumettre la rÃ©ponse
        form.addEventListener("submit", async e => {
          e.preventDefault();
          await submitReply(modal);
        });
      }
      // Soumettre la rÃ©ponse
      async function submitReply(modal) {
        const tweetId = modal.dataset.tweetId;
        const content = modal.querySelector("#replyContent").value.trim();
        const imageInput = modal.querySelector("#replyImage");
        const submitBtn = modal.querySelector("#submitReply");
        if (!content) return;
        // DÃ©sactiver le bouton pendant l'envoi
        submitBtn.disabled = true;
        submitBtn.textContent = "Envoi...";
        try {
          const formData = new FormData();
          formData.append("content", content);
          formData.append("tweet_id", tweetId);
          if (imageInput.files[0]) {
            formData.append("image", imageInput.files[0]);
          }
          const response = await fetch(`/tweets/${tweetId}/replies`, {
            method: "POST",
            body: formData,
            headers: {
              "X-Requested-With": "XMLHttpRequest",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            }
          });
          const result = await response.json();
          if (response.ok && result.success) {
            // Fermer le modal
            modal.classList.add("hidden");
            // IncrÃ©menter le compteur de rÃ©ponses
            updateRepliesCount(tweetId, 1);
            // Afficher un message de succÃ¨s
            showSuccessMessage("RÃ©ponse publiÃ©e avec succÃ¨s !");
          } else {
            throw new Error(result.message || "Erreur lors de la publication");
          }
        } catch (error) {
          console.error("Erreur lors de la publication de la rÃ©ponse:", error);
          alert("Erreur lors de la publication de la rÃ©ponse");
        } finally {
          // RÃ©activer le bouton
          submitBtn.disabled = false;
          submitBtn.textContent = "RÃ©pondre";
        }
      }
      // Mettre Ã  jour le compteur de rÃ©ponses
      function updateRepliesCount(tweetId, increment) {
        const replyBtns = document.querySelectorAll(`.reply-btn[data-tweet-id="${tweetId}"]`);
        replyBtns.forEach(btn => {
          const countSpan = btn.querySelector(".replies-count");
          if (countSpan) {
            const currentCount = parseInt(countSpan.textContent) || 0;
            const newCount = currentCount + increment;
            countSpan.textContent = newCount > 0 ? newCount : "";
          }
        });
      }
      // Afficher un message de succÃ¨s
      function showSuccessMessage(message) {
        const successDiv = document.createElement("div");
        successDiv.className = "fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50";
        successDiv.textContent = message;
        document.body.appendChild(successDiv);
        setTimeout(() => {
          successDiv.remove();
        }, 3e3);
      }
      // VÃ©rifier si on doit ouvrir automatiquement le composeur de tweet
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get("compose") === "true") {
        // Auto-focus sur le formulaire de tweet avec un dÃ©lai pour s'assurer que tout est chargÃ©
        setTimeout(() => {
          focusTweetComposer();
          // Supprimer le paramÃ¨tre de l'URL pour nettoyer l'historique
          window.history.replaceState({}, document.title, window.location.pathname);
        }, 300);
      }

      // ===============================
      // GROK AI FUNCTIONALITY
      // ===============================

      // Gestion de la modale Grok
      const grokModal = document.getElementById("grokModal");
      const grokButton = document.getElementById("grokButton");
      const closeGrokModal = document.getElementById("closeGrokModal");

      console.log("ğŸ¤– Ã‰lÃ©ments Grok trouvÃ©s:", {
        modal: !!grokModal,
        button: !!grokButton,
        closeButton: !!closeGrokModal
      });

      if (!grokButton) {
        console.error("âŒ Bouton Grok non trouvÃ© ! ID: 'grokButton'");
      }

      if (!grokModal) {
        console.error("âŒ Modale Grok non trouvÃ©e ! ID: 'grokModal'");
      }      // Ouvrir/fermer la modale
      if (grokButton) {
        // Test si le bouton est visible
        const buttonRect = grokButton.getBoundingClientRect();
        console.log("ğŸ¤– Position bouton Grok:", {
          visible: buttonRect.width > 0 && buttonRect.height > 0,
          position: { x: buttonRect.x, y: buttonRect.y, width: buttonRect.width, height: buttonRect.height }
        });

        grokButton.addEventListener("click", (e) => {
          console.log("ğŸ¤– Clic sur bouton Grok dÃ©tectÃ©", e);
          console.log("ğŸ¤– Modale avant ouverture:", grokModal?.classList.contains("hidden"));
          grokModal?.classList.remove("hidden");
          console.log("ğŸ¤– Modale aprÃ¨s ouverture:", grokModal?.classList.contains("hidden"));
        });

        // Test clic programmatique
        console.log("ğŸ¤– Ajout d'un test clic dans 3 secondes...");
        setTimeout(() => {
          console.log("ğŸ¤– Test clic programmatique sur bouton Grok");
          grokButton.click();
        }, 3000);
      } else {
        console.error("âŒ Impossible d'ajouter l'event listener - bouton non trouvÃ©");
      }

      closeGrokModal?.addEventListener("click", () => {
        grokModal.classList.add("hidden");
      });

      // Fermer en cliquant Ã  l'extÃ©rieur
      grokModal?.addEventListener("click", (e) => {
        if (e.target === grokModal) {
          grokModal.classList.add("hidden");
        }
      });

      // Gestion des onglets Grok
      const grokTabs = document.querySelectorAll(".grok-tab");
      const grokTabContents = document.querySelectorAll(".grok-tab-content");

      grokTabs.forEach(tab => {
        tab.addEventListener("click", () => {
          // DÃ©sactiver tous les onglets
          grokTabs.forEach(t => {
            t.classList.remove("active", "bg-purple-600", "text-white");
            t.classList.add("text-gray-400", "hover:text-white");
          });

          // Activer l'onglet cliquÃ©
          tab.classList.add("active", "bg-purple-600", "text-white");
          tab.classList.remove("text-gray-400", "hover:text-white");

          // Masquer tous les contenus
          grokTabContents.forEach(content => content.classList.add("hidden"));

          // Afficher le contenu correspondant
          const tabId = tab.getAttribute("data-tab");
          const content = document.getElementById(`grok-${tabId}`);
          if (content) {
            content.classList.remove("hidden");
          }
        });
      });

      // Initialiser le premier onglet comme actif
      document.querySelector(".grok-tab")?.classList.add("bg-purple-600", "text-white");

      // Fonctions utilitaires
      function getCurrentTweetContent() {
        return document.getElementById("tweetContent")?.value || "";
      }

      function showGrokLoading(buttonId) {
        const button = document.getElementById(buttonId);
        if (button) {
          button.disabled = true;
          button.innerHTML = '<div class="flex items-center justify-center"><div class="animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"></div><span class="ml-2">Traitement...</span></div>';
        }
      }

      function hideGrokLoading(buttonId, originalText) {
        const button = document.getElementById(buttonId);
        if (button) {
          button.disabled = false;
          button.innerHTML = originalText;
        }
      }

      // GÃ©nÃ©rer du contenu
      document.getElementById("generateContentBtn")?.addEventListener("click", async () => {
        const prompt = document.getElementById("generatePrompt").value.trim();
        const tone = document.getElementById("generateTone").value;

        if (!prompt) {
          alert("Veuillez saisir une idÃ©e ou un sujet");
          return;
        }

        showGrokLoading("generateContentBtn");
        console.log("ğŸ¤– GÃ©nÃ©ration de contenu Grok...");
        console.log("ğŸ¤– DonnÃ©es envoyÃ©es:", { prompt, tone, maxLength: 280 });

        try {
          const response = await fetch("/grok/generate-content", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            },
            body: JSON.stringify({ prompt, tone, maxLength: 280 })
          });

          console.log("ğŸ¤– RÃ©ponse reÃ§ue:", response.status, response.statusText);
          const result = await response.json();
          console.log("ğŸ¤– RÃ©sultat JSON:", result);

          if (result.success && result.data) {
            displayGeneratedContent(result.data);
            console.log(`âœ… ${result.data.length} suggestions gÃ©nÃ©rÃ©es`);
          } else {
            throw new Error(result.error || "Erreur lors de la gÃ©nÃ©ration");
          }
        } catch (error) {
          console.error("Erreur gÃ©nÃ©ration:", error);
          alert("Erreur lors de la gÃ©nÃ©ration de contenu");
        } finally {
          hideGrokLoading("generateContentBtn", "âœ¨ GÃ©nÃ©rer du contenu");
        }
      });

      function displayGeneratedContent(suggestions) {
        const resultsDiv = document.getElementById("generatedResults");
        const suggestionsDiv = document.getElementById("generatedSuggestions");

        suggestionsDiv.innerHTML = "";

        suggestions.forEach((suggestion, index) => {
          const div = document.createElement("div");
          div.className = "bg-gray-800 p-3 rounded-lg border border-gray-700";
          div.innerHTML = `
            <div class="flex justify-between items-start mb-2">
              <span class="text-xs text-purple-400 font-medium uppercase">${suggestion.tone}</span>
              <button onclick="useSuggestion('${suggestion.content.replace(/'/g, "\\'")}', ${index})" 
                class="text-xs text-blue-400 hover:text-blue-300 underline">Utiliser</button>
            </div>
            <p class="text-white text-sm">${suggestion.content}</p>
            ${suggestion.hashtags && suggestion.hashtags.length > 0 ?
              `<div class="mt-2 flex flex-wrap gap-1">${suggestion.hashtags.map(tag =>
                `<span class="text-xs bg-purple-600 bg-opacity-30 text-purple-300 px-2 py-1 rounded">${tag}</span>`
              ).join('')}</div>` : ''}
          `;
          suggestionsDiv.appendChild(div);
        });

        resultsDiv.classList.remove("hidden");
      }

      // Fonction globale pour utiliser une suggestion
      window.useSuggestion = function (content, index) {
        const tweetTextarea = document.getElementById("tweetContent");
        if (tweetTextarea) {
          tweetTextarea.value = content;
          tweetTextarea.focus();
          // Mettre Ã  jour le compteur de caractÃ¨res
          updateCharCount();
          grokModal.classList.add("hidden");
          console.log(`âœ… Suggestion ${index + 1} utilisÃ©e`);
        }
      };

      // SuggÃ©rer des hashtags
      document.getElementById("suggestHashtagsBtn")?.addEventListener("click", async () => {
        const content = document.getElementById("hashtagContent").value.trim();
        const maxSuggestions = parseInt(document.getElementById("maxHashtags").value) || 5;

        if (!content) {
          alert("Veuillez saisir le contenu du tweet");
          return;
        }

        showGrokLoading("suggestHashtagsBtn");
        console.log("ğŸ·ï¸ GÃ©nÃ©ration de hashtags Grok...");

        try {
          const response = await fetch("/grok/suggest-hashtags", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            },
            body: JSON.stringify({ content, maxSuggestions })
          });

          const result = await response.json();

          if (result.success && result.data) {
            displayHashtagSuggestions(result.data);
            console.log(`âœ… ${result.data.length} hashtags suggÃ©rÃ©s`);
          } else {
            throw new Error(result.error || "Erreur lors de la suggestion");
          }
        } catch (error) {
          console.error("Erreur hashtags:", error);
          alert("Erreur lors de la gÃ©nÃ©ration de hashtags");
        } finally {
          hideGrokLoading("suggestHashtagsBtn", "ğŸ·ï¸ SuggÃ©rer des hashtags");
        }
      });

      function displayHashtagSuggestions(suggestions) {
        const resultsDiv = document.getElementById("hashtagResults");
        const suggestionsDiv = document.getElementById("hashtagSuggestions");

        suggestionsDiv.innerHTML = "";

        suggestions.forEach(suggestion => {
          const div = document.createElement("div");
          div.className = "flex items-center justify-between bg-gray-800 p-3 rounded-lg border border-gray-700";
          div.innerHTML = `
            <div class="flex-1">
              <div class="flex items-center space-x-2">
                <span class="text-blue-400 font-medium">${suggestion.hashtag}</span>
                <div class="w-full bg-gray-700 rounded-full h-2 max-w-20">
                  <div class="bg-purple-500 h-2 rounded-full" style="width: ${suggestion.relevance * 100}%"></div>
                </div>
                <span class="text-xs text-gray-400">${Math.round(suggestion.relevance * 100)}%</span>
              </div>
              <p class="text-xs text-gray-400 mt-1">${suggestion.reason}</p>
            </div>
            <button onclick="addHashtag('${suggestion.hashtag}')" 
              class="text-xs text-green-400 hover:text-green-300 underline ml-2">Ajouter</button>
          `;
          suggestionsDiv.appendChild(div);
        });

        resultsDiv.classList.remove("hidden");
      }

      // Fonction globale pour ajouter un hashtag
      window.addHashtag = function (hashtag) {
        const tweetTextarea = document.getElementById("tweetContent");
        if (tweetTextarea) {
          const currentContent = tweetTextarea.value;
          const newContent = currentContent + (currentContent ? ' ' : '') + hashtag;

          if (newContent.length <= 280) {
            tweetTextarea.value = newContent;
            tweetTextarea.focus();
            updateCharCount();
            console.log(`âœ… Hashtag ${hashtag} ajoutÃ©`);
          } else {
            alert("Ajout du hashtag dÃ©passerait la limite de 280 caractÃ¨res");
          }
        }
      };

      // Boutons "Utiliser le tweet actuel"
      document.getElementById("useCurrentTweet")?.addEventListener("click", () => {
        const currentContent = getCurrentTweetContent();
        document.getElementById("hashtagContent").value = currentContent;
      });

      document.getElementById("useCurrentTweetAnalyze")?.addEventListener("click", () => {
        const currentContent = getCurrentTweetContent();
        document.getElementById("analyzeContent").value = currentContent;
      });

      document.getElementById("useCurrentTweetOptimize")?.addEventListener("click", () => {
        const currentContent = getCurrentTweetContent();
        document.getElementById("optimizeContent").value = currentContent;
      });

      // Analyser un tweet
      document.getElementById("analyzeTweetBtn")?.addEventListener("click", async () => {
        const content = document.getElementById("analyzeContent").value.trim();

        if (!content) {
          alert("Veuillez saisir le contenu du tweet Ã  analyser");
          return;
        }

        showGrokLoading("analyzeTweetBtn");
        console.log("ğŸ“Š Analyse tweet Grok...");

        try {
          const response = await fetch("/grok/analyze-tweet", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            },
            body: JSON.stringify({ content })
          });

          const result = await response.json();

          if (result.success && result.data) {
            displayTweetAnalysis(result.data);
            console.log(`âœ… Analyse terminÃ©e: ${result.data.sentiment}`);
          } else {
            throw new Error(result.error || "Erreur lors de l'analyse");
          }
        } catch (error) {
          console.error("Erreur analyse:", error);
          alert("Erreur lors de l'analyse du tweet");
        } finally {
          hideGrokLoading("analyzeTweetBtn", "ğŸ“Š Analyser le tweet");
        }
      });

      function displayTweetAnalysis(analysis) {
        const resultsDiv = document.getElementById("analyzeResults");
        const detailsDiv = document.getElementById("analyzeDetails");

        const sentimentColor = analysis.sentiment === 'positive' ? 'text-green-400' :
          analysis.sentiment === 'negative' ? 'text-red-400' : 'text-yellow-400';

        detailsDiv.innerHTML = `
          <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <h5 class="text-sm font-medium text-gray-300">Sentiment</h5>
                <p class="${sentimentColor} font-medium capitalize">${analysis.sentiment}</p>
              </div>
              <div>
                <h5 class="text-sm font-medium text-gray-300">Score d'engagement</h5>
                <p class="text-white font-medium">${Math.round(analysis.engagement_score)}/100</p>
              </div>
            </div>
            
            ${analysis.suggested_improvements.length > 0 ? `
              <div class="mb-4">
                <h5 class="text-sm font-medium text-gray-300 mb-2">AmÃ©liorations suggÃ©rÃ©es</h5>
                <ul class="space-y-1 text-sm text-gray-400">
                  ${analysis.suggested_improvements.map(improvement =>
          `<li>â€¢ ${improvement}</li>`
        ).join('')}
                </ul>
              </div>
            ` : ''}
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
              <div>
                <h5 class="font-medium text-gray-300">Meilleur moment</h5>
                <p class="text-gray-400">${analysis.best_posting_time}</p>
              </div>
            </div>
            
            ${analysis.audience_insights.length > 0 ? `
              <div class="mt-4">
                <h5 class="text-sm font-medium text-gray-300 mb-2">Insights audience</h5>
                <ul class="space-y-1 text-sm text-gray-400">
                  ${analysis.audience_insights.map(insight =>
          `<li>â€¢ ${insight}</li>`
        ).join('')}
                </ul>
              </div>
            ` : ''}
          </div>
        `;

        resultsDiv.classList.remove("hidden");
      }

      // Optimiser un tweet
      document.getElementById("optimizeTweetBtn")?.addEventListener("click", async () => {
        const content = document.getElementById("optimizeContent").value.trim();

        if (!content) {
          alert("Veuillez saisir le contenu du tweet Ã  optimiser");
          return;
        }

        showGrokLoading("optimizeTweetBtn");
        console.log("ğŸš€ Optimisation tweet Grok...");

        try {
          const response = await fetch("/grok/optimize-tweet", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "X-CSRF-TOKEN": document.querySelector('meta[name="csrf-token"]')?.getAttribute("content") || ""
            },
            body: JSON.stringify({ content })
          });

          const result = await response.json();

          if (result.success && result.data) {
            displayTweetOptimization(result.data);
            console.log(`âœ… Optimisation terminÃ©e`);
          } else {
            throw new Error(result.error || "Erreur lors de l'optimisation");
          }
        } catch (error) {
          console.error("Erreur optimisation:", error);
          alert("Erreur lors de l'optimisation du tweet");
        } finally {
          hideGrokLoading("optimizeTweetBtn", "ğŸš€ Optimiser le tweet");
        }
      });

      function displayTweetOptimization(optimization) {
        const resultsDiv = document.getElementById("optimizeResults");
        const detailsDiv = document.getElementById("optimizeDetails");

        detailsDiv.innerHTML = `
          <div class="space-y-4">
            <!-- Tweet original -->
            <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
              <h5 class="text-sm font-medium text-gray-300 mb-2">Tweet original</h5>
              <p class="text-gray-400 text-sm">${optimization.original}</p>
            </div>
            
            <!-- Analyse -->
            <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
              <h5 class="text-sm font-medium text-gray-300 mb-2">Analyse</h5>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <span class="text-xs text-gray-400">Sentiment:</span>
                  <span class="text-white ml-1">${optimization.analysis.sentiment}</span>
                </div>
                <div>
                  <span class="text-xs text-gray-400">Score:</span>
                  <span class="text-white ml-1">${Math.round(optimization.analysis.engagement_score)}/100</span>
                </div>
              </div>
            </div>
            
            <!-- Versions amÃ©liorÃ©es -->
            ${optimization.improved_suggestions.length > 0 ? `
              <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
                <h5 class="text-sm font-medium text-gray-300 mb-3">Versions optimisÃ©es</h5>
                <div class="space-y-3">
                  ${optimization.improved_suggestions.map((suggestion, index) => `
                    <div class="bg-gray-700 p-3 rounded-lg">
                      <div class="flex justify-between items-start mb-2">
                        <span class="text-xs text-purple-400 font-medium">${suggestion.tone}</span>
                        <button onclick="useSuggestion('${suggestion.content.replace(/'/g, "\\'")}', ${index})" 
                          class="text-xs text-blue-400 hover:text-blue-300 underline">Utiliser</button>
                      </div>
                      <p class="text-white text-sm">${suggestion.content}</p>
                    </div>
                  `).join('')}
                </div>
              </div>
            ` : ''}
            
            <!-- Hashtags suggÃ©rÃ©s -->
            ${optimization.hashtag_suggestions.length > 0 ? `
              <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
                <h5 class="text-sm font-medium text-gray-300 mb-3">Hashtags recommandÃ©s</h5>
                <div class="flex flex-wrap gap-2">
                  ${optimization.hashtag_suggestions.map(hashtag => `
                    <button onclick="addHashtag('${hashtag.hashtag}')" 
                      class="bg-purple-600 bg-opacity-30 text-purple-300 px-3 py-1 rounded-full text-sm hover:bg-opacity-50 transition-colors">
                      ${hashtag.hashtag}
                    </button>
                  `).join('')}
                </div>
              </div>
            ` : ''}
            
            <!-- Conseils d'optimisation -->
            <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
              <h5 class="text-sm font-medium text-gray-300 mb-3">Conseils d'optimisation</h5>
              <ul class="space-y-2 text-sm text-gray-400">
                ${optimization.optimization_tips.map(tip => `<li>â€¢ ${tip}</li>`).join('')}
              </ul>
            </div>
          </div>
        `;

        resultsDiv.classList.remove("hidden");
      }

      console.log("ğŸ¤– Grok AI initialisÃ© avec succÃ¨s!");

      // Test manuel modale Grok
      window.openGrokModal = function () {
        console.log("ğŸ§ª Ouverture manuelle modale Grok");
        const modal = document.getElementById("grokModal");
        if (modal) {
          modal.classList.remove("hidden");
          console.log("âœ… Modale ouverte manuellement");
        } else {
          console.log("âŒ Modale non trouvÃ©e");
        }
      };

      // Test simple Grok
      window.testGrok = async function () {
        console.log("ğŸ§ª Test simple Grok...");
        try {
          const response = await fetch("/grok/test", {
            method: "GET",
            headers: {
              "Content-Type": "application/json",
            }
          });

          console.log("ğŸ§ª RÃ©ponse test:", response.status, response.statusText);
          const result = await response.json();
          console.log("ğŸ§ª RÃ©sultat test:", result);
          alert("Test Grok: " + (result.success ? "SUCCÃˆS" : "Ã‰CHEC"));
        } catch (error) {
          console.error("ğŸ§ª Erreur test:", error);
          alert("Erreur test Grok: " + error.message);
        }
      };

    });
  </script>

</body>

</html>